DROP TABLE IF EXISTS user_actions CASCADE;
DROP TABLE IF EXISTS events_similarity CASCADE;

CREATE TABLE IF NOT EXISTS user_actions (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    event_id BIGINT NOT NULL,
    user_id BIGINT NOT NULL,
    weight DOUBLE PRECISION NOT NULL,
    ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,

    UNIQUE(event_id, user_id)
);

CREATE TABLE IF NOT EXISTS events_similarity (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
    event_a_id BIGINT NOT NULL,
    event_b_id BIGINT NOT NULL,
    score DOUBLE PRECISION NOT NULL,
    ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,

    UNIQUE(event_a_id, event_b_id)
);
